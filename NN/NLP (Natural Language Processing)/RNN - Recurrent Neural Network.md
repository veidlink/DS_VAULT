# üìö References 
- Tags :  [[NLP (Natural language processing)]] 
- Links:  [–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è](https://github.com/Elbrus-DataScience/ds-phase-2/blob/master/slides/RNN.pdf)

# ‚ùì Questions
- –í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º–∞ –≤–∑—Ä—ã–≤–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞?
- –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–∫—Ç–∏–≤–∞—Ü–∏—é ReLU –≤–º–µ—Å—Ç–æ tanh?  
*–ù–∏–∫–æ–≥–¥–∞, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–∑-–∑–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞*
- –î–ª—è —á–µ–≥–æ –µ—Å—Ç—å —Å–º—ã—Å–ª –¥–æ–±–∞–≤–ª—è—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ RNN —Å–ª–æ–∏? 
*–ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏*
- –û–±—ä—è—Å–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é init_hidden() –≤ –æ–±—É—á–∞—é—â–µ–º —Ü–∏–∫–ª–µ (–ó–∞—á–µ–º –Ω–∞–º —á—Ç–æ-—Ç–æ –∫—Ä–æ–º–µ hidden_dim –Ω–∞ –≤—Ö–æ–¥–µ?)
*–í —Ç–æ—Ä—á–µ –Ω–µ –Ω—É–∂–Ω–æ, –≤—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–µ—Ç—Å—è*

# üîó Related material
-  [Word2vec –≤ –∫–∞—Ä—Ç–∏–Ω–∫–∞—Ö](https://habr.com/ru/post/446530/)
- [–ß—É–¥–µ—Å–Ω—ã–π –º–∏—Ä Word Embeddings: –∫–∞–∫–∏–µ –æ–Ω–∏ –±—ã–≤–∞—é—Ç –∏ –∑–∞—á–µ–º –Ω—É–∂–Ω—ã?](https://habr.com/ru/company/ods/blog/329410/)
- [Vanilla Recurrent Neural Network](https://calvinfeng.gitbook.io/machine-learning-notebook/supervised-learning/recurrent-neural-network/recurrent_neural_networks)
- [–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–∞—Å—Ç–µ–π —Ä–µ—á–∏ / POS (part of speech) tagging](https://becominghuman.ai/part-of-speech-tagging-tutorial-with-the-keras-deep-learning-library-d7f93fa05537)
- [–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–º–µ–Ω–æ–≤–∞–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π / NER (named entity recognition)](https://habr.com/ru/company/abbyy/blog/449514/)
- [Seq2seq –ø–æ–¥—Ö–æ–¥ / sequence to sequence](https://habr.com/ru/post/440472/)
- [LTSM networks](https://subscription.packtpub.com/book/big_data_and_business_intelligence/9781788399906/10/ch10lvl1sec62/implementation-of-the-language-model), [–°—Ö–µ–º–∞ –¥–ª—è LTSM –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–µ–º–Ω–æ–≥–æ –¥—Ä—É–≥–∞—è](https://elbrus-ds-cheatsheets.streamlit.app/%F0%9F%82%93_rnn)
- [–í–∑—Ä—ã–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –≤ RNN](https://gblobscdn.gitbook.com/assets%2F-LIA3amopGH9NC6Rf0mA%2F-M4bJ-IWAKzglR0XHFwU%2F-M4bJ2qhkeQ1-xH49LhY%2Frnn-gradient-flow.png?alt=media)



# –†–ï–ö–ö–£–†–ï–ù–¢–ù–´–ï –ù–ï–ô–†–û–ù–ù–´–ï –°–ï–¢–ò
## –°—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–µ–π—Ä–æ–Ω–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π

![Structure](NN/NLP%20(Natural%20Language%20Processing)/imgs/1.png)

**One-to-one [[Neural Networks]]** —ç—Ç–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, CNN (—Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω.–Ω.), –∫–æ—Ç–æ—Ä–æ–π –Ω–∞ –≤—Ö–æ–¥ –¥–∞–µ—Ç—Å—è 1 —Ñ–æ—Ç–æ, –∞ –Ω–∞ –≤—ã—Ö–æ–¥ –æ–Ω–∞ –≤—ã–¥–∞–µ—Ç –∫–ª–∞—Å—Å.

**One-to-many NN** - Image captioning. –ù–∞ –≤—Ö–æ–¥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–∞ –≤—ã—Ö–æ–¥ –º–æ–¥–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –Ω–µ–º. (–ö–æ—Ç, —Å–∏–¥–∏—Ç, –Ω–∞ —Å—Ç–æ–ª–µ...)

**Many-to-one NN** -  –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é –≥–µ–Ω–µ—Ä–∏—Ç —Ñ–æ—Ç–æ, —Ç.–µ. –¥–µ–ª–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ–µ. –ò–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (–¥–æ–±—Ä—ã–π/–∑–ª–æ–π –æ—Ç–∑—ã–≤)

**Many-to-many** ([[Seq2Seq]]) - –ø–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞. –í—Ç–æ—Ä–∞ —Å—Ö–µ–º–∞ —ç—Ç–æ –ø–æ—Ö–æ–∂–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - —Å–µ—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –≤ –Ω–µ—Å–ª—É—á–∞–π–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ, —Å—É—â, –≥–ª–∞–≥...)
## –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã RNN 

![Scheme](NN/NLP%20(Natural%20Language%20Processing)/imgs/2.png)

$h_{n}$ - hidden state. Hidden state - —ç—Ç–æ –∏—Å—Ç–æ—Ä–∏—è. –ß–µ–º –±–æ–ª—å—à–µ hidden size, —Ç–µ–º –±–æ–ª—å—à–µ —Å–µ—Ç—å –ø–æ–º–Ω–∏—Ç –æ –ø—Ä–æ—à–ª—ã—Ö —Å–ª–æ–≤–∞—Ö.
$f_{w}$  - —ç—Ç–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è  $h_{n-1}$ –∏ $x_{n}$, –≥–¥–µ w - —ç—Ç–æ –∫–∞–∫–∏–µ-—Ç–æ –≤–µ—Å–∞ (–≤–µ—Å–∞ –≤–µ–∑–¥–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Å –ø–æ–º–æ—â—å—é [[Back propagation]])
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, $h_{n+1}$ —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ $x_{n}$ c $h_{n-1}$.  –≠—Ç–∏–º –ø—É—Ç–µ–º –≤—Å–µ h —Ö—Ä–∞–Ω—è—Ç –ø–∞–º—è—Ç—å –æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏—è—Ö. -> RNN –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ "–∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏".

<center>–ü—Ä–∏–º–µ—Ä: <center>

*–ï—Å–ª–∏ NN –¥–∞–Ω–∞ —Ü–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–∑—ã–≤, —Ç–æ h –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –≤ –≤–µ–∫—Ç–æ—Ä–µ –Ω–µ–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–µ –∞–±—Å—Ç—Ä–∞—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ [[Feature maps]] –≤ CNN), –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π –ª–∏ –æ—Ç–∑—ã–≤.*

<mark style="background: #FF5582A6;">**–ë–æ–ª–µ–µ —Å–ª–æ–∂–∞—è –≤–µ—Ä—Å–∏—è —Å–µ—Ç–∏** 
</mark>

![More complicated](NN/NLP%20(Natural%20Language%20Processing)/imgs/3.png)
–ù–∞–¥—Å—Ç—Ä–æ–π–∫–∞ –≤—ã—à–µ –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–±—â–∏–π Loss, –¥–µ—Ä–≥–∞—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏–∑ —Å–µ—Ç–∏ –∏ —Å—á–∏—Ç–∞—è –∏—Ö –ø–æ—Ç–µ—Ä–∏.

<center>–ü—Ä–∏–º–µ—Ä—ã: <center>

1) NN –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —á–∞—Å—Ç—å —Ä–µ—á–∏. –ù–∞ $h_{1}$ –æ–Ω–∞ —Å–∫–∞–∑–∞–ª–∞ "–ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ", –Ω–∞ $h_{2}$ - "—Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ", –∏–±–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –ø–∞—Ä—É –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ-—Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã—à–µ. –ù–æ –Ω–∞ –¥–µ–ª–µ $x_{2}$ –æ–∫–∞–∑–∞–ª–æ—Å—å –µ—â–µ –æ–¥–Ω–∏–º –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–º, $L_{2}$ - –ø–æ—Å—á–∏—Ç–∞–Ω–Ω—ã–π –ª–æ—Å—Å.

2) –ü–æ—Å–∏–º–≤–æ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ–≤–∞ 'Hello'

![Hello!](4.png)

<mark style="background: #FF5582A6;">**–ï—â–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ**</mark>

![Elaborated](5.png)

- –õ–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π –¥–ª—è –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞ (embedding'a) –∏—â–µ—Ç –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–ª–æ–≤–∞–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ.

- –õ–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π –¥–ª—è hidden state –∏—â–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É¬†–≤—Å–µ–º–∏ —Å–ª–æ–≤–∞–º–∏, —Ö—Ä–∞–Ω—è—â–∏—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏ RNN.

<mark style="background: #FF5582A6;">**Embedding —Å–ª–æ–π**</mark>

![Embedding](6.png)

Pad —ç—Ç–æ —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ [[Padding]] –≤ Convolutional Layer(Filter or Kernel) –≤ CNN. –û–Ω –Ω—É–∂–µ–Ω, —á—Ç–æ–±—ã —É –≤—Å–µ—Ö —ç–º–±–µ–¥–∏–Ω–≥–æ–≤ –±—ã–ª–∞ –æ–¥–Ω–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, —Ç–∞–∫ –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ —ç–º–±—ç–¥–∏–Ω–≥–∏, –¥–ª–∏–Ω–Ω—ã–µ - –æ–±—Ä–µ–∑–∞—é—Ç.

<mark style="background: #FF5582A6;">**–û–±—â–∞—è —Å—Ö–µ–º–∞**</mark>

![Overall Scheme](7.png)


- –†–µ–∫–∫—É—Ä–µ–Ω—Ç–Ω—ã–π —Å–ª–æ–π **–≤ —Ü–µ–ª–æ–º** –¥–µ–ª–∞–µ—Ç –ª–∏—à—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤—ã–¥–µ—Ä–≥–∏–≤–∞—é—Ç—Å—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ
- –í —Å–ª—É—á–∞–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –∏ –≤—ã–¥–µ—Ä–Ω—É—Ç–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–∞–≤–Ω—ã.

## –ü—Ä–æ–±–ª–µ–º—ã RNN

1. –ó–∞—Ç—É—Ö–∞–Ω–∏–µ / –≤–∑—Ä—ã–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
–∞. –ó–∞—Ç—É—Ö–∞–µ—Ç –∫–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–∞—è –∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–º –ø–æ–∫–∞ –¥–æ–π–¥–µ—Ç –¥–æ –ø–µ—Ä–≤—ã—Ö —Å–ª–æ–≤.
–±. ***–ö–æ–≥–¥–∞ –≤–∑—Ä—ã–≤–∞–µ—Ç—Å—è?***
2. –ó–∞–±—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç
